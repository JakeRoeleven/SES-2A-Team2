{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/jaker/Desktop/SES-2A-Team2/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/jaker/Desktop/SES-2A-Team2/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/jaker/Desktop/SES-2A-Team2/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Grid,Container,CssBaseline,Typography,Card,TextField,Button,FormControl,InputLabel,Select,MenuItem,CircularProgress}from'@material-ui/core';import{Form}from'semantic-ui-react';import InterestSelect from'../components/InterestSelects';import MajorSelect from'../components/MajorSelect';import CoursesCompleted from'../components/CompletedCourses';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Account(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];// User Details\nvar _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),userDetails=_useState4[0],setUserDetails=_useState4[1];var _useState5=useState('Last Name'),_useState6=_slicedToArray(_useState5,2),lastname=_useState6[0],setLastName=_useState6[1];var _useState7=useState('Last Name'),_useState8=_slicedToArray(_useState7,2),firstname=_useState8[0],setFirstName=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),year=_useState10[0],setYear=_useState10[1];var _useState11=useState('Your Degree'),_useState12=_slicedToArray(_useState11,2),degree=_useState12[0],setDegree=_useState12[1];var _useState13=useState('Your Faculty'),_useState14=_slicedToArray(_useState13,2),faculty=_useState14[0],setFaculty=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),interests=_useState16[0],setInterests=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),displayed_interests=_useState18[0],setDisplayedInterests=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),coursesCompleted=_useState20[0],setCoursesCompleted=_useState20[1];var setDetailsFromFirebase=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(details){var name,interests_obj_array;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(details!=null){setUserDetails(details);// Courses Completed\nsetCoursesCompleted(details['courses_completed']);// Name stuff\nname=details['name'].split(' ');setFirstName(name[0]);setLastName(name[1]);// Year\nsetYear(details['year']);// Degree\nsetDegree(details['degree']);// Major\nsetFaculty(details['major']);// Interests stuff - TODO: Find a better solution\nsetInterests(details['interests']);interests_obj_array=[];details['interests'].forEach(function(elem){interests_obj_array.push({value:elem,label:elem});});setDisplayedInterests(interests_obj_array);}case 1:case\"end\":return _context.stop();}}},_callee);}));return function setDetailsFromFirebase(_x){return _ref.apply(this,arguments);};}();var getStudentData=function getStudentData(){var student={};// Push id from firebase\nstudent['id']=userDetails._id;student[\"student_data\"]={};student[\"student_data\"]['name']=firstname.concat(\" \").concat(lastname);//TODO: Need degrees\nstudent[\"student_data\"]['degree']=degree;student[\"student_data\"]['major']=faculty;student[\"student_data\"]['year']=year;student[\"student_data\"]['postgraduate']=false;student[\"student_data\"]['interests']=interests;return student;};// Post student details to database\nvar submitAccountUpdate=function submitAccountUpdate(){var student_data=getStudentData();fetch('http://localhost:8080/api/update-student',{method:'POST',body:JSON.stringify(student_data),headers:{'Content-Type':'application/json'}}).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){var error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(res.status===200)){_context2.next=5;break;}alert(\"Details updated\");fetchStudent();_context2.next=11;break;case 5:_context2.t0=JSON;_context2.next=8;return res.json();case 8:_context2.t1=_context2.sent;error=_context2.t0.parse.call(_context2.t0,_context2.t1);alert(error);case 11:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}()).catch(function(err){alert(err);});};// Get student details from database\nvar fetchStudent=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var id;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:id=sessionStorage.getItem('user_id');fetch(\"http://localhost:8080/api/student/\".concat(id),{crossDomain:true,mode:'cors',method:'GET',headers:{'Content-Type':'application/json','Access-Control-Allow-Origin':'*'}}).then(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(res){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return res.json();case 2:data=_context3.sent;setDetailsFromFirebase(data);setLoading(false);case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref4.apply(this,arguments);};}()).catch(function(err){console.log(err);});case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function fetchStudent(){return _ref3.apply(this,arguments);};}();useEffect(function(){if(userDetails==null){fetchStudent();}else{setLoading(false);}},[fetchStudent,setLoading,userDetails]);if(loading){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsxs(Container,{maxWidth:false,children:[/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,children:/*#__PURE__*/_jsx(Grid,{item:true,xs:8,children:/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",children:[' ',\"Edit Your Account\",' ']})})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Card,{style:{padding:'2%',overflow:'visible',textAlign:'center'},children:/*#__PURE__*/_jsx(CircularProgress,{})})]})]});}else{return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsxs(Container,{maxWidth:false,children:[/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,children:/*#__PURE__*/_jsx(Grid,{item:true,xs:8,children:/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",children:[' ',\"Edit Your Account\",' ']})})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Card,{style:{padding:'2%',overflow:'visible'},children:[/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsx(TextField,{id:\"outlined-disabled\",label:\"First Name\",defaultValue:firstname,value:firstname,onChange:function onChange(event){return setFirstName(event.target.value);},variant:\"outlined\",style:{marginRight:'2%'}}),/*#__PURE__*/_jsx(TextField,{id:\"outlined-disabled\",label:\"Last Name\",defaultValue:lastname,value:lastname,onChange:function onChange(event){return setLastName(event.target.value);},variant:\"outlined\",style:{marginRight:'2%'}}),/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",style:{minWidth:'120px'},children:[/*#__PURE__*/_jsx(InputLabel,{htmlFor:\"outlined-age-native-simple\",children:\"Degree Year\"}),/*#__PURE__*/_jsxs(Select,{defaultValue:year,value:year,onChange:function onChange(e){return setYear(e.target.value);},label:\"Degree Year\",children:[/*#__PURE__*/_jsx(MenuItem,{value:1,children:\"1\"}),/*#__PURE__*/_jsx(MenuItem,{value:2,children:\"2\"}),/*#__PURE__*/_jsx(MenuItem,{value:3,children:\"3\"}),/*#__PURE__*/_jsx(MenuItem,{value:4,children:\"4\"}),/*#__PURE__*/_jsx(MenuItem,{value:5,children:\"5\"}),/*#__PURE__*/_jsx(MenuItem,{value:6,children:\"6\"})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(TextField,{id:\"outlined-disabled\",label:\"Degree\",defaultValue:degree,value:degree,fullWidth:\"true\",onChange:function onChange(event){return setDegree(event.target.value);},variant:\"outlined\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Typography,{style:{fontSize:'1.2em',marginBottom:'10px'},variant:\"h6\",children:\"Your Faculty\"}),/*#__PURE__*/_jsx(MajorSelect,{setMajor:setFaculty,major:faculty}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Typography,{style:{fontSize:'1.2em',marginBottom:'10px'},variant:\"h6\",children:\"Your Interests\"}),/*#__PURE__*/_jsx(InterestSelect,{displayed_interests:displayed_interests,setCurrentInterests:setInterests,setDisplayedInterests:setDisplayedInterests})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{style:{float:'right'},onClick:function onClick(){return submitAccountUpdate();},children:\" Update Account \"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Typography,{style:{fontSize:'1.2em'},variant:\"h6\",children:\"Courses You Have Completed\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(CoursesCompleted,{courses:coursesCompleted,student:userDetails})]})]})]});}}export default Account;","map":{"version":3,"sources":["C:/Users/jaker/Desktop/SES-2A-Team2/Frontend/src/pages/Account.js"],"names":["React","useState","useEffect","Grid","Container","CssBaseline","Typography","Card","TextField","Button","FormControl","InputLabel","Select","MenuItem","CircularProgress","Form","InterestSelect","MajorSelect","CoursesCompleted","Account","loading","setLoading","userDetails","setUserDetails","lastname","setLastName","firstname","setFirstName","year","setYear","degree","setDegree","faculty","setFaculty","interests","setInterests","displayed_interests","setDisplayedInterests","coursesCompleted","setCoursesCompleted","setDetailsFromFirebase","details","name","split","interests_obj_array","forEach","elem","push","value","label","getStudentData","student","_id","concat","submitAccountUpdate","student_data","fetch","method","body","JSON","stringify","headers","then","res","status","alert","fetchStudent","json","error","parse","catch","err","id","sessionStorage","getItem","crossDomain","mode","data","console","log","padding","overflow","textAlign","event","target","marginRight","minWidth","e","fontSize","marginBottom","float"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport {\r\n    Grid,\r\n    Container,\r\n    CssBaseline,\r\n    Typography,\r\n    Card,\r\n    TextField, \r\n    Button,\r\n    FormControl,\r\n    InputLabel,\r\n    Select,\r\n    MenuItem,\r\n    CircularProgress\r\n} from '@material-ui/core';\r\nimport {Form} from 'semantic-ui-react';\r\n\r\nimport InterestSelect from '../components/InterestSelects';\r\nimport MajorSelect from '../components/MajorSelect';\r\nimport CoursesCompleted from '../components/CompletedCourses';\r\n\r\nfunction Account() {\r\n\r\n    const [loading, setLoading] = useState(true);\r\n    \r\n    // User Details\r\n    const [userDetails, setUserDetails] = useState(null);\r\n    const [lastname, setLastName] = useState('Last Name');\r\n    const [firstname, setFirstName] = useState('Last Name');\r\n    const [year, setYear] = useState(0);\r\n    const [degree, setDegree] = useState('Your Degree');\r\n    const [faculty, setFaculty] = useState('Your Faculty');\r\n    const [interests, setInterests] = useState([]);\r\n    const [displayed_interests, setDisplayedInterests] = useState([]);\r\n    const [coursesCompleted, setCoursesCompleted] = useState([]);\r\n\r\n    const setDetailsFromFirebase = async (details) => {\r\n        if (details != null) {\r\n            setUserDetails(details)\r\n\r\n            // Courses Completed\r\n            setCoursesCompleted(details['courses_completed']);\r\n            \r\n            // Name stuff\r\n            let name = details['name'].split(' ');\r\n            setFirstName(name[0])\r\n            setLastName(name[1])\r\n\r\n            // Year\r\n            setYear(details['year'])\r\n\r\n            // Degree\r\n            setDegree(details['degree'])\r\n\r\n            // Major\r\n            setFaculty(details['major'])\r\n\r\n            // Interests stuff - TODO: Find a better solution\r\n            setInterests(details['interests'])\r\n            let interests_obj_array = [];\r\n            details['interests'].forEach(elem => {\r\n                interests_obj_array.push({value: elem, label: elem});\r\n            })\r\n            setDisplayedInterests(interests_obj_array);\r\n\r\n        }\r\n    }\r\n\r\n    const getStudentData = () => {\r\n\r\n\t\tlet student = {}\r\n\r\n\t\t// Push id from firebase\r\n\t\tstudent['id'] = userDetails._id;\r\n\r\n\t\tstudent[\"student_data\"] = {}\r\n\t\tstudent[\"student_data\"]['name'] = firstname.concat(\" \").concat(lastname)\r\n\t\t\r\n        //TODO: Need degrees\r\n        student[\"student_data\"]['degree'] = degree;\r\n        student[\"student_data\"]['major'] = faculty;\r\n\t\tstudent[\"student_data\"]['year'] = year;\r\n\t\tstudent[\"student_data\"]['postgraduate'] = false;\r\n\t\tstudent[\"student_data\"]['interests'] = interests;\r\n\r\n\t\treturn student;\r\n\t}\r\n\r\n    // Post student details to database\r\n    const submitAccountUpdate = () => {\r\n\r\n        let student_data = getStudentData()\r\n\r\n        fetch('http://localhost:8080/api/update-student', {\r\n        \tmethod: 'POST',\r\n        \tbody: JSON.stringify(student_data),\r\n        \theaders: {\r\n        \t\t'Content-Type': 'application/json'\r\n        \t}\r\n        })\r\n        \t.then(async (res) => {\r\n        \t\tif (res.status === 200) {\r\n                    alert(\"Details updated\")\r\n                    fetchStudent()\r\n        \t\t} else {\r\n        \t\t\tconst error = JSON.parse(await res.json());\r\n\t\t\t\t\talert(error)\r\n        \t\t}\r\n        \t})\r\n        \t.catch(err => {\r\n        \t\talert(err)\r\n        });\r\n    }\r\n\r\n    // Get student details from database\r\n    const fetchStudent = async () => {\r\n        let id = sessionStorage.getItem('user_id');\r\n        fetch(`http://localhost:8080/api/student/${id}`, {\r\n            crossDomain: true,\r\n            mode: 'cors',\r\n            method: 'GET',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Access-Control-Allow-Origin': '*',\r\n            },\r\n        })\r\n            .then(async (res) => {\r\n                let data = await res.json();\r\n                setDetailsFromFirebase(data);\r\n                setLoading(false);\r\n            })\r\n            .catch((err) => {\r\n                console.log(err);\r\n        });\r\n    };\r\n\r\n    useEffect(() => {\r\n        if(userDetails == null) {\r\n            fetchStudent();\r\n        } else {\r\n            setLoading(false);\r\n        }\r\n    }, [fetchStudent, setLoading, userDetails]);\r\n\r\n    if (loading) {\r\n        return (\r\n            <>\r\n            <CssBaseline />\r\n            <Container maxWidth={false}>\r\n                <Grid container spacing={3}>\r\n                    <Grid item xs={8}>\r\n                        <Typography variant='h5'>\r\n                            {' '}\r\n                            Edit Your Account{' '}\r\n                        </Typography>\r\n                    </Grid>\r\n                </Grid>\r\n                <br />\r\n                <Card style={{ padding: '2%', overflow: 'visible', textAlign: 'center'}}>\r\n                    <CircularProgress />\r\n                </Card>\r\n            </Container>\r\n            </>\r\n        )\r\n    } else {\r\n        return (\r\n            <>\r\n                <CssBaseline />\r\n                <Container maxWidth={false}>\r\n                    <Grid container spacing={3}>\r\n                        <Grid item xs={8}>\r\n                            <Typography variant='h5'>\r\n                                {' '}\r\n                                Edit Your Account{' '}\r\n                            </Typography>\r\n                        </Grid>\r\n                    </Grid>\r\n                    <br />\r\n                    <Card style={{ padding: '2%', overflow: 'visible'}}>\r\n                        <Form>\r\n    \r\n                            <TextField\r\n                                id=\"outlined-disabled\"\r\n                                label=\"First Name\"\r\n                                defaultValue={firstname}\r\n                                value={firstname}\r\n                                onChange={(event) => setFirstName(event.target.value)}\r\n                                variant=\"outlined\"\r\n                                style={{ marginRight: '2%' }}\r\n                            />\r\n    \r\n                            <TextField\r\n                                id=\"outlined-disabled\"\r\n                                label=\"Last Name\"\r\n                                defaultValue={lastname}\r\n                                value={lastname}\r\n                                onChange={(event) => setLastName(event.target.value)}\r\n                                variant=\"outlined\"\r\n                                style={{ marginRight: '2%' }}\r\n                            />\r\n    \r\n                            <FormControl variant=\"outlined\" style={{ minWidth: '120px' }}>\r\n                                <InputLabel htmlFor=\"outlined-age-native-simple\">Degree Year</InputLabel>\r\n                                <Select defaultValue={year} value={year} onChange={(e) => setYear(e.target.value)} label=\"Degree Year\">\r\n                                    <MenuItem value={1}>1</MenuItem>\r\n                                    <MenuItem value={2}>2</MenuItem>\r\n                                    <MenuItem value={3}>3</MenuItem>\r\n                                    <MenuItem value={4}>4</MenuItem>\r\n                                    <MenuItem value={5}>5</MenuItem>\r\n                                    <MenuItem value={6}>6</MenuItem>   \r\n                                </Select>\r\n                            </FormControl>\r\n    \r\n                            <br /><br />\r\n    \r\n                            <TextField\r\n                                id=\"outlined-disabled\"\r\n                                label=\"Degree\"\r\n                                defaultValue={degree}\r\n                                value={degree}\r\n                                fullWidth=\"true\"\r\n                                onChange={(event) => setDegree(event.target.value)}\r\n                                variant=\"outlined\"\r\n                            />\r\n    \r\n                            <br /><br />\r\n                            <Typography style={{ fontSize: '1.2em', marginBottom: '10px' }}  variant='h6'>Your Faculty</Typography>\r\n                            <MajorSelect setMajor={setFaculty} major={faculty}/>\r\n                            <br />\r\n                            <Typography style={{ fontSize: '1.2em', marginBottom: '10px' }}  variant='h6'>Your Interests</Typography>\r\n                            <InterestSelect \r\n                                displayed_interests={displayed_interests} \r\n                                setCurrentInterests={setInterests} \r\n                                setDisplayedInterests={setDisplayedInterests} />\r\n                        </Form>\r\n                        <br /><br />\r\n                        <Button style={{ float: 'right' }} onClick={() => submitAccountUpdate()}> Update Account </Button>\r\n                        <br /><br />\r\n                        <Typography style={{ fontSize: '1.2em' }}  variant='h6'>Courses You Have Completed</Typography>\r\n                        <br />\r\n                        <CoursesCompleted courses={coursesCompleted} student={userDetails}/>\r\n                    </Card>\r\n                </Container>\r\n            </>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nexport default Account;\r\n"]},"metadata":{},"sourceType":"module"}